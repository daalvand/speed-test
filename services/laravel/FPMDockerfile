FROM richarvey/nginx-php-fpm

# Set the working directory in the container
WORKDIR /var/www/html

# Copy your application files to the container
COPY . .

# Modify Nginx configuration to serve from the 'public' directory
RUN sed -i -e "s|root /var/www/html;|root /var/www/html/public;|g" /etc/nginx/sites-available/default.conf \
    && sed -i -e "s|root /var/www/html;|root /var/www/html/public;|g" /etc/nginx/sites-available/default-ssl.conf


RUN cp .env.example .env
RUN composer install -o --no-dev
RUN php artisan key:generate
RUN php artisan optimize
